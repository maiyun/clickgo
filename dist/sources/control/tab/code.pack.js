var emodule=function(t){"use strict";function s(t){var s=Object.create(null);return t&&Object.keys(t).forEach(function(e){if("default"!==e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(s,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})}}),s.default=t,Object.freeze(s)}var e=s(t);class i extends e.control.AbstractControl{get filename(){return"/code.js"}constructor(){super(...arguments),this.emits={close:null,change:null,changed:null,"update:tabs":null,"update:modelValue":null},this.props={tabPosition:"top",drag:!1,close:!1,tabs:[],modelValue:""},this.arrow=!1,this.timer=0,this.tabsData=[],this.oldTabs=void 0,this.value="",this.rand=""}get isDrag(){return e.tool.getBoolean(this.props.drag)}get isClose(){return e.tool.getBoolean(this.props.close)}get tabsComp(){const t=[];for(const s of this.tabsData)"object"!=typeof s?t.push({label:s,value:s,drag:this.isDrag,close:this.isClose}):t.push({label:s.label??s.value??"error",value:s.value??s.label??"error",drag:s.drag??this.isDrag,close:s.close??this.isClose});return t}get values(){const t=[];for(const s of this.tabsComp)t.push(s.value);return t}wheel(t){"left"!==this.props.tabPosition&&"right"!==this.props.tabPosition?0===t.deltaX?this.refs.tabs[0].scrollLeft+=t.deltaY:this.refs.tabs[0].scrollLeft+=t.deltaX:this.refs.tabs[0].scrollTop+=t.deltaY}down(t,s){const i=this.tabsComp[s].value;this.value!==i&&(this.value=i,this.emit("update:modelValue",this.value)),e.dom.bindDrag(t,{el:t.currentTarget.parentNode,data:{index:s,tab:this.rand}})}tabClose(t,s,e){const i={go:!0,preventDefault:function(){this.go=!1},detail:{index:s,value:e}};this.emit("close",i),i.go&&(t.stopPropagation(),this.tabsData.splice(s,1),this.emit("update:tabs",this.tabsData))}drop(t,s){"object"==typeof t.detail.value&&t.detail.value.tab===this.rand&&(this.tabsData.splice(s,0,this.tabsData.splice(t.detail.value.index,1)[0]),this.emit("update:tabs",this.tabsData))}tabClick(t,s){const e={go:!0,preventDefault:function(){this.go=!1},detail:{value:s.value}};if(this.emit("change",e),!e.go)return;this.value=s.value,this.emit("update:modelValue",this.value);const i={detail:{value:s.value}};this.emit("changed",i)}longDown(t,s){if(e.dom.hasTouchButMouse(t))return;const i="start"===s?-5:5;e.dom.bindDown(t,{down:()=>{this.timer=e.task.onFrame(this,()=>{"top"===this.props.tabPosition||"bottom"===this.props.tabPosition?this.refs.tabs[0].scrollLeft+=i:this.refs.tabs[0].scrollTop+=i})},up:()=>{e.task.offFrame(this,this.timer),this.timer=0}})}onResize(){const t=this.refs.tabs[0];if("top"===this.props.tabPosition||"bottom"===this.props.tabPosition){const s=this.arrow?t.clientWidth+40:t.clientWidth;t.scrollWidth>s?this.arrow=!0:this.arrow=!1}else{const s=this.arrow?t.clientHeight+40:t.clientHeight;t.scrollHeight>s?this.arrow=!0:this.arrow=!1}}refreshValue(){if(""===this.value){const t=this.values[0]?this.values[0]:"";this.value!==t&&(this.value=t,this.emit("update:modelValue",this.value))}else if(!this.values.includes(this.value)){const t=this.values[this.values.length-1]?this.values[this.values.length-1]:"";this.value!==t&&(this.value=t,this.emit("update:modelValue",this.value))}}onMounted(){this.watch("tabs",()=>{this.tabsData=e.tool.clone(this.props.tabs)},{deep:!0,immediate:!0}),this.watch("modelValue",()=>{this.value!==this.props.modelValue&&(this.value=this.props.modelValue,this.refreshValue())},{immediate:!0}),this.watch("tabsComp",()=>{this.refreshValue(),this.nextTick().then(()=>{this.onResize()}).catch(()=>{})},{deep:!0}),this.watch("tabPosition",async()=>{await this.nextTick(),this.oldTabs!==this.refs.tabs[0]&&(this.oldTabs=this.refs.tabs[0],e.dom.watchSize(this,this.refs.tabs[0],()=>{this.onResize()}))}),this.rand=e.tool.random(16),this.oldTabs=this.refs.tabs[0],e.dom.watchSize(this,this.refs.tabs[0],()=>{this.onResize()}),this.refreshValue()}}return i}(clickgo.modules.clickgo);