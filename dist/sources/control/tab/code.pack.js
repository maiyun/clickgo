var emodule=function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(s){if("default"!==s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}}),e.default=t,Object.freeze(e)}var s=e(t);class a extends s.control.AbstractControl{get filename(){return"/code.js"}emits={close:null,change:null,changed:null,"update:tabs":null,"update:modelValue":null};props={tabPosition:"top",drag:!1,close:!1,tabs:[],modelValue:""};arrow=!1;timer=0;tabsData=[];oldTabs=void 0;value="";rand="";get isDrag(){return s.tool.getBoolean(this.props.drag)}get isClose(){return s.tool.getBoolean(this.props.close)}get tabsComp(){const t=[];for(const e of this.tabsData)"object"!=typeof e?t.push({label:e,value:e,drag:this.isDrag,close:this.isClose}):t.push({label:e.label??e.value??"error",value:e.value??e.label??"error",drag:e.drag??this.isDrag,close:e.close??this.isClose});return t}get values(){const t=[];for(const e of this.tabsComp)t.push(e.value);return t}wheel(t){"left"!==this.props.tabPosition&&"right"!==this.props.tabPosition?0===t.deltaX?this.refs.tabs[0].scrollLeft+=t.deltaY:this.refs.tabs[0].scrollLeft+=t.deltaX:this.refs.tabs[0].scrollTop+=t.deltaY}down(t,e){const a=this.tabsComp[e].value;this.value!==a&&(this.value=a,this.emit("update:modelValue",this.value)),s.modules.pointer.drag(t,t.currentTarget.parentNode,{data:{index:e,tab:this.rand}})}tabClose(t,e,s){const a={go:!0,preventDefault:function(){this.go=!1},detail:{index:e,value:s}};this.emit("close",a),a.go&&(t.stopPropagation(),this.tabsData.splice(e,1),this.emit("update:tabs",this.tabsData))}drop(t,e){"object"==typeof t.detail.value&&t.detail.value.tab===this.rand&&(this.tabsData.splice(e,0,this.tabsData.splice(t.detail.value.index,1)[0]),this.emit("update:tabs",this.tabsData))}tabClick(t,e){const s={go:!0,preventDefault:function(){this.go=!1},detail:{value:e.value}};if(this.emit("change",s),!s.go)return;this.value=e.value,this.emit("update:modelValue",this.value);const a={detail:{value:e.value}};this.emit("changed",a)}longDown(t,e){const a="start"===e?-5:5;s.modules.pointer.down(t,{down:()=>{this.timer=s.task.onFrame(this,()=>{"top"===this.props.tabPosition||"bottom"===this.props.tabPosition?this.refs.tabs[0].scrollLeft+=a:this.refs.tabs[0].scrollTop+=a})},up:()=>{s.task.offFrame(this,this.timer),this.timer=0}})}onResize(){const t=this.refs.tabs[0];if("top"===this.props.tabPosition||"bottom"===this.props.tabPosition){const e=this.arrow?t.clientWidth+40:t.clientWidth;t.scrollWidth>e?this.arrow=!0:this.arrow=!1}else{const e=this.arrow?t.clientHeight+40:t.clientHeight;t.scrollHeight>e?this.arrow=!0:this.arrow=!1}}refreshValue(){if(""===this.value){const t=this.values[0]?this.values[0]:"";this.value!==t&&(this.value=t,this.emit("update:modelValue",this.value))}else if(!this.values.includes(this.value)){const t=this.values[this.values.length-1]?this.values[this.values.length-1]:"";this.value!==t&&(this.value=t,this.emit("update:modelValue",this.value))}}onMounted(){this.watch("tabs",()=>{this.tabsData=s.tool.clone(this.props.tabs)},{deep:!0,immediate:!0}),this.watch("modelValue",()=>{this.value!==this.props.modelValue&&(this.value=this.props.modelValue,this.refreshValue())},{immediate:!0}),this.watch("tabsComp",()=>{this.refreshValue(),this.nextTick().then(()=>{this.onResize()}).catch(()=>{})},{deep:!0}),this.watch("tabPosition",async()=>{await this.nextTick(),this.oldTabs!==this.refs.tabs[0]&&(this.oldTabs=this.refs.tabs[0],s.dom.watchSize(this,this.refs.tabs[0],()=>{this.onResize()}))}),this.rand=s.tool.random(16),this.oldTabs=this.refs.tabs[0],s.dom.watchSize(this,this.refs.tabs[0],()=>{this.onResize()}),this.refreshValue()}}return a}(clickgo.modules.clickgo);