var emodule=function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var i=e(t);class s extends i.control.AbstractControl{get filename(){return"/code.js"}constructor(){super(...arguments),this.emits={imgselect:null,imgupload:null,init:null,html:null,"update:modelValue":null},this.props={disabled:!1,modelValue:"",visual:!1,theme:"light"},this.notInit=!1,this.isLoading=!0,this.localeData={en:{copy:"Copy",cut:"Cut",paste:"Paste"},sc:{copy:"复制",cut:"剪下",paste:"粘上"},tc:{copy:"複製",cut:"剪貼",paste:"貼上"},ja:{copy:"コピー",cut:"切り取り",paste:"貼り付け"},ko:{copy:"복사",cut:"잘라내기",paste:"붙여넣기"},th:{copy:"คัดลอก",cut:"ตัด",paste:"วาง"},es:{copy:"Copiar",cut:"Cortar",paste:"Pegar"},de:{copy:"Kopieren",cut:"Ausschneiden",paste:"Einfügen"},fr:{copy:"Copier",cut:"Couper",paste:"Coller"},pt:{copy:"Copiar",cut:"Recortar",paste:"Colar"},ru:{copy:"Копировать",cut:"Вырезать",paste:"Вставить"},vi:{copy:"Sao chép",cut:"Cắt",paste:"Dán"}},this.access={tuieditor:void 0}}async execCmd(t){switch(t){case"copy":i.tool.execCommand(t);break;case"cut":i.tool.execCommand("copy"),this.access.tuieditor.insertText("");break;case"paste":try{const t=await navigator.clipboard.read();for(const e of t){if(!e.types.length)continue;if(1===e.types.length){if(e.types[0].includes("text")){const t=await e.getType(e.types[0]);this.access.tuieditor.insertText(await t.text());continue}const t={detail:{file:await e.getType(e.types[0]),callback:(t,e)=>{e&&(e.width??e.height)&&this.access.tuieditor.isMarkdownMode()?this.access.tuieditor.replaceSelection(`<div${e.align?' align="center"':""}><img src="${t}"${e.alt?` alt="${e.alt}"`:""}${e.width?` width="${e.width}"`:""}${e.height?` height="${e.height}"`:""}></div>`):this.access.tuieditor.exec("addImage",{imageUrl:t,altText:e?.alt??""})}}};this.emit("imgupload",t);continue}const t=await e.getType(e.types[1]);let i=await t.text();i=i.replace(/<img.+?src=['"](.+?)['"].+?>/gi,"\n\n![image]($1)\n\n").replace(/<\/img>/gi,"").replace(/<[^>]*>/g,""),this.access.tuieditor.insertText(i)}}catch{break}}}getLanguage(){switch(this.locale){case"sc":return"zh-CN";case"tc":return"zh-TW"}return this.locale}async onMounted(){const t=await i.core.getModule("@toast-ui/editor");if(!t)return this.isLoading=!1,void(this.notInit=!0);this.access.tuieditor=new t.Editor({el:this.refs.content,height:"initial",previewStyle:"vertical",initialEditType:this.propBoolean("visual")?"wysiwyg":"markdown",hideModeSwitch:!0,theme:this.props.theme,initialValue:this.props.modelValue,language:this.getLanguage(),autofocus:!1,usageStatistics:!1,hooks:{addImageBlobHook:t=>{const e={detail:{file:t,callback:(t,e)=>{e&&(e.width??e.height)&&this.access.tuieditor.isMarkdownMode()?this.access.tuieditor.replaceSelection(`<div${e.align?' align="center"':""}><img src="${t}"${e.alt?` alt="${e.alt}"`:""}${e.width?` width="${e.width}"`:""}${e.height?` height="${e.height}"`:""}></div>`):this.access.tuieditor.exec("addImage",{imageUrl:t,altText:e?.alt??""})}}};this.emit("imgupload",e)}},events:{change:()=>{this.emit("update:modelValue",this.access.tuieditor.getMarkdown()),this.emit("html",this.access.tuieditor.getHTML())}},toolbarItems:[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task","indent","outdent"],["table","link"],["code","codeblock"],["scrollSync"]]});const e=i.dom.createElement("button");e.className="image toastui-editor-toolbar-icons",e.style.margin="0",e.addEventListener("click",()=>{this.emit("imgselect",(t,e)=>{e&&(e.width??e.height)&&this.access.tuieditor.isMarkdownMode()?this.access.tuieditor.replaceSelection(`<div${e.align?' align="center"':""}><img src="${t}"${e.alt?` alt="${e.alt}"`:""}${e.width?` width="${e.width}"`:""}${e.height?` height="${e.height}"`:""}></div>`):this.access.tuieditor.exec("addImage",{imageUrl:t,altText:e?.alt??""})})}),this.access.tuieditor.insertToolbarItem({groupIndex:3,itemIndex:1},{el:e,tooltip:this.access.tuieditor.i18n.get("Insert image")}),this.element.addEventListener("contextmenu",t=>{if(t.preventDefault(),i.dom.hasTouchButMouse(t))return;const e=t.target;(e.classList.contains("ProseMirror")||i.dom.findParentByClass(e,"ProseMirror"))&&("table"===e.tagName.toLowerCase()||i.dom.findParentByTag(e,"table")||i.form.showPop(this.element,this.refs.pop,t))}),this.element.addEventListener("paste",t=>{if(t.clipboardData&&!this.propBoolean("visual"))for(const e of t.clipboardData.items)"file"!==e.kind&&(t.preventDefault(),e.getAsString(t=>{t=t.replace(/<img.+?src=['"](.+?)['"].+?>/gi,"\n\n![image]($1)\n\n").replace(/<\/img>/gi,"").replace(/<[^>]*>/g,""),this.access.tuieditor.insertText(t)}))});const s=t=>{if(i.dom.hasTouchButMouse(t))return;void 0!==this.element.dataset.cgPopOpen&&i.form.hidePop(this.element);const e=t.target;(e.classList.contains("ProseMirror")||i.dom.findParentByClass(e,"ProseMirror"))&&t instanceof TouchEvent&&i.dom.bindLong(t,()=>{i.form.showPop(this.element,this.refs.pop,t)})};this.element.addEventListener("mousedown",s),this.element.addEventListener("touchstart",s,{passive:!0}),this.watch("locale",()=>{this.access.tuieditor}),this.watch("visual",()=>{this.access.tuieditor&&this.access.tuieditor.changeMode(this.propBoolean("visual")?"wysiwyg":"markdown")}),this.watch("theme",()=>{if(!this.access.tuieditor)return;const t=this.refs.content.children[0];"dark"===this.props.theme?t.classList.contains("toastui-editor-dark")||t.classList.add("toastui-editor-dark"):t.classList.contains("toastui-editor-dark")&&t.classList.remove("toastui-editor-dark")},{immediate:!0}),this.watch("modelValue",t=>{this.access.tuieditor&&t!==this.access.tuieditor.getMarkdown()&&this.access.tuieditor.setMarkdown(t)}),i.dom.watchStyle(this.element,["font-size","font-family"],(t,e)=>{if(!this.access.tuieditor)return;const i=this.refs.content.querySelector(".ProseMirror");if(i)switch(t){case"font-size":i.style.fontSize=e;break;case"font-family":i.style.fontFamily=e}},!0),this.isLoading=!1,this.emit("init",this.access.tuieditor),this.props.modelValue&&this.emit("html",this.access.tuieditor.getHTML())}}return s}(clickgo.modules.clickgo);