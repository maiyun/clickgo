var emodule=function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var i=e(t);class s extends i.control.AbstractControl{get filename(){return"/code.js"}constructor(){super(...arguments),this.emits={focus:null,blur:null,enter:null,gesture:null,input:null,clientwidth:null,clientheight:null,scrollwidth:null,scrollheight:null,beforechange:null,changed:null,minmaxchange:null,"update:modelValue":null,"update:scrollLeft":null,"update:scrollTop":null,"update:selectionStart":null,"update:selectionEnd":null},this.props={disabled:!1,readonly:!1,wrap:!0,maxlength:0,scroll:!0,gesture:[],type:"text",plain:!1,require:!1,rule:"",padding:"m",modelValue:"",placeholder:"",selectionStart:0,selectionEnd:0,scrollLeft:0,scrollTop:0,max:void 0,min:void 0},this.showPassword=!1,this.isFocus=!1,this.value="",this.size={sw:0,sh:0,cw:0,ch:0,st:0,sl:0},this.localeData={en:{copy:"Copy",cut:"Cut",paste:"Paste"},sc:{copy:"复制",cut:"剪下",paste:"粘上"},tc:{copy:"複製",cut:"剪貼",paste:"貼上"},ja:{copy:"コピー",cut:"切り取り",paste:"貼り付け"},ko:{copy:"복사",cut:"잘라내기",paste:"붙여넣기"},th:{copy:"คัดลอก",cut:"ตัด",paste:"วาง"},es:{copy:"Copiar",cut:"Cortar",paste:"Pegar"},de:{copy:"Kopieren",cut:"Ausschneiden",paste:"Einfügen"},fr:{copy:"Copier",cut:"Couper",paste:"Coller"},pt:{copy:"Copiar",cut:"Recortar",paste:"Colar"},ru:{copy:"Копировать",cut:"Вырезать",paste:"Вставить"},vi:{copy:"Sao chép",cut:"Cắt",paste:"Dán"}},this.dangerBorder=!1}focus(){this.refs.text.focus()}maxScrollLeft(){return this.refs.text.scrollWidth-this.refs.text.clientWidth}maxScrollTop(){return this.refs.text.scrollHeight-this.refs.text.clientHeight}down(t){i.dom.hasTouchButMouse(t)||void 0!==this.element.dataset.cgPopOpen&&i.form.hidePop()}tfocus(){this.isFocus=!0,this.emit("focus"),this.dangerBorder&&(this.dangerBorder=!1)}tblur(t){const e=t.target;if(this.checkNumber(e)){const t={go:!0,preventDefault:function(){this.go=!1},detail:{before:this.value,value:e.value}};if(this.emit("minmaxchange",t),t.go){const t={go:!0,preventDefault:function(){this.go=!1},detail:{value:e.value,change:void 0}};this.emit("beforechange",t),t.go?(void 0!==t.detail.change&&(e.value=t.detail.change),this.value=e.value,this.emit("update:modelValue",this.value),this.emit("changed")):e.value=this.value}else e.value=this.value}this.isFocus=!1,this.emit("blur"),this.check()}input(t){const e=t.target,i={go:!0,preventDefault:function(){this.go=!1},detail:{value:e.value,change:void 0}};if(this.emit("beforechange",i),!i.go)return e.value=this.value,void this.emit("input");void 0!==i.detail.change&&(e.value=i.detail.change),this.value=e.value,this.emit("update:modelValue",this.value),this.emit("changed"),this.emit("input")}checkNumber(t){if(t??=this.refs.text,"number"!==this.props.type)return!1;let e=!1;if(!t.value&&this.value&&(e=!0),t.value){const i=parseFloat(t.value);void 0!==this.props.max&&"undefined"!==this.props.max&&i>this.propNumber("max")&&(t.value=this.propNumber("max").toString(),e=!0),void 0!==this.props.min&&"undefined"!==this.props.min&&i<this.propNumber("min")&&(t.value=this.propNumber("min").toString(),e=!0)}return e}scrollEvent(){let t=Math.round(this.refs.text.scrollLeft);const e=this.maxScrollLeft();t>e&&(t=e),this.size.sl=t,this.propInt("scrollLeft")!==t&&this.emit("update:scrollLeft",t);let i=Math.round(this.refs.text.scrollTop);const s=this.maxScrollTop();i>s&&(i=s),this.size.st=i,this.propInt("scrollTop")!==i&&this.emit("update:scrollTop",i)}wheel(t){i.dom.bindGesture(t,(t,e)=>{switch(e){case"top":if(this.refs.text.scrollTop>0)return-1;if(this.propArray("gesture").includes("top"))return 1;break;case"bottom":if(Math.round(this.refs.text.scrollTop)<this.maxScrollTop())return-1;if(this.propArray("gesture").includes("bottom"))return 1;break;case"left":if(this.refs.text.scrollLeft>0)return-1;if(this.propArray("gesture").includes("left"))return 1;break;default:if(Math.round(this.refs.text.scrollLeft)<this.maxScrollLeft())return-1;if(this.propArray("gesture").includes("right"))return 1}return 0},t=>{this.emit("gesture",t)})}inputTouch(t){i.dom.bindGesture(t,(t,e)=>{switch(e){case"top":if(this.refs.text.scrollTop>0)return-1;if(this.propArray("gesture").includes("top"))return 1;break;case"bottom":if(Math.round(this.refs.text.scrollTop)<this.maxScrollTop())return-1;if(this.propArray("gesture").includes("bottom"))return 1;break;case"left":if(this.refs.text.scrollLeft>0)return-1;if(this.propArray("gesture").includes("left"))return 1;break;default:if(Math.round(this.refs.text.scrollLeft)<this.maxScrollLeft())return-1;if(this.propArray("gesture").includes("right"))return 1}return 0},t=>{this.emit("gesture",t)}),navigator.clipboard&&i.dom.bindLong(t,()=>{i.form.showPop(this.element,this.refs.pop,t)})}contextmenu(t){navigator.clipboard?i.dom.hasTouchButMouse(t)||i.form.showPop(this.element,this.refs.pop,t):t.stopPropagation()}select(t){t.stopPropagation()}numberClick(t){this.value||(this.value="0");const e=(parseFloat(this.value)+t).toString(),i={go:!0,preventDefault:function(){this.go=!1},detail:{value:e,change:void 0}};this.emit("beforechange",i),i.go&&(this.value=i.detail.change??e,this.emit("update:modelValue",this.value),this.emit("changed"))}async execCmd(t){if(this.refs.text.focus(),"paste"===t){if(this.propBoolean("readonly"))return;const t=await navigator.clipboard.readText(),e={go:!0,preventDefault:function(){this.go=!1},detail:{value:this.value.slice(0,this.refs.text.selectionStart)+t+this.value.slice(this.refs.text.selectionEnd),change:void 0}};if(this.emit("beforechange",e),!e.go)return;this.value=e.detail.change??this.value.slice(0,this.refs.text.selectionStart)+t+this.value.slice(this.refs.text.selectionEnd),this.emit("update:modelValue",this.value),this.emit("changed"),this.refs.text.selectionStart=this.refs.text.selectionStart+t.length,this.refs.text.selectionEnd=this.refs.text.selectionStart}else i.tool.execCommand(t)}checkWatch(){i.dom.isWatchProperty(this.refs.text)||(i.dom.watchProperty(this.refs.text,["selectionStart","selectionEnd","scrollWidth","scrollHeight"],(t,e)=>{switch(null===e&&(e=0),t){case"selectionStart":case"selectionEnd":this.emit("update:"+t,e);break;case"scrollWidth":case"scrollHeight":this.emit(t.toLowerCase(),e),"scrollWidth"===t?this.size.sw=parseFloat(e):this.size.sh=parseFloat(e)}},!0),i.dom.watchSize(this,this.refs.text,()=>{this.size.cw=this.refs.text.clientWidth,this.emit("clientwidth",this.refs.text.clientWidth),this.size.ch=this.refs.text.clientHeight,this.emit("clientheight",this.refs.text.clientHeight)},!0))}keydown(t){"Enter"===t.key&&this.emit("enter")}check(){if(this.propBoolean("require")&&!this.value)return this.dangerBorder=!0,!1;if(!this.value)return!0;if(!this.props.rule)return!0;return!!(this.props.rule instanceof RegExp?this.props.rule:new RegExp(this.props.rule.slice(1,-1))).test(this.value)||(this.dangerBorder=!0,!1)}kbdown(t){t.preventDefault()}showKeyboard(){i.form.showKeyboard()}onMounted(){this.watch("modelValue",async()=>{if(this.value===this.props.modelValue)return;if(this.dangerBorder&&(this.dangerBorder=!1),this.value=this.props.modelValue,await this.nextTick(),this.checkNumber(),this.propNumber("maxlength")&&this.refs.text.value.length>this.propNumber("maxlength")&&(this.refs.text.value=this.refs.text.value.slice(0,this.propNumber("maxlength"))),this.refs.text.value===this.value)return void this.check();const t={go:!0,preventDefault:function(){this.go=!1},detail:{value:this.refs.text.value,change:void 0}};if(this.emit("beforechange",t),!t.go)return this.check(),void(this.refs.text.value=this.value);this.value=t.detail.change??this.refs.text.value,this.emit("update:modelValue",this.value),this.emit("changed"),this.check()},{immediate:!0}),this.watch("type",async()=>{if(await this.nextTick(),this.checkNumber()){const t={go:!0,preventDefault:function(){this.go=!1},detail:{before:this.value,value:this.refs.text.value}};if(this.emit("minmaxchange",t),t.go){const t={go:!0,preventDefault:function(){this.go=!1},detail:{value:this.value,change:void 0}};this.emit("beforechange",t),t.go?(this.value=t.detail.change??this.refs.text.value,this.emit("update:modelValue",this.value),this.emit("changed")):this.refs.text.value=this.value}}await this.nextTick(),this.checkWatch()}),this.watch("max",async()=>{if(await this.nextTick(),this.checkNumber()){const t={go:!0,preventDefault:function(){this.go=!1},detail:{before:this.value,value:this.refs.text.value}};if(this.emit("minmaxchange",t),!t.go)return void(this.refs.text.value=this.value);const e={go:!0,preventDefault:function(){this.go=!1},detail:{value:this.value,change:void 0}};if(this.emit("beforechange",e),!e.go)return void(this.refs.text.value=this.value);this.value=e.detail.change??this.refs.text.value,this.emit("update:modelValue",this.value),this.emit("changed")}}),this.watch("min",async()=>{if(await this.nextTick(),this.checkNumber()){const t={go:!0,preventDefault:function(){this.go=!1},detail:{before:this.value,value:this.refs.text.value}};if(this.emit("minmaxchange",t),!t.go)return void(this.refs.text.value=this.value);const e={go:!0,preventDefault:function(){this.go=!1},detail:{value:this.value,change:void 0}};if(this.emit("beforechange",e),!e.go)return void(this.refs.text.value=this.value);this.value=e.detail.change??this.refs.text.value,this.emit("update:modelValue",this.value),this.emit("changed")}}),this.watch("maxlength",()=>{if(!this.propNumber("maxlength"))return;if(this.value.length<=this.propNumber("maxlength"))return;const t=this.value.slice(0,this.propNumber("maxlength")),e={go:!0,preventDefault:function(){this.go=!1},detail:{value:t,change:void 0}};this.emit("beforechange",e),e.go&&(this.value=e.detail.change??t,this.emit("update:modelValue",this.value),this.emit("changed"))}),this.watch("scrollLeft",()=>{const t=this.propInt("scrollLeft");t!==Math.round(this.refs.text.scrollLeft)&&(this.refs.text.scrollLeft=t)}),this.watch("scrollTop",()=>{const t=this.propInt("scrollTop");t!==Math.round(this.refs.text.scrollTop)&&(this.refs.text.scrollTop=t)}),this.watch("selectionStart",()=>{const t=this.propInt("selectionStart");t!==this.refs.text.selectionStart&&"number"!==this.props.type&&(this.refs.text.selectionStart=t)}),this.watch("selectionEnd",()=>{const t=this.propInt("selectionEnd");t!==this.refs.text.selectionEnd&&"number"!==this.props.type&&(this.refs.text.selectionEnd=t)});const t=this.parentByName("content");t&&this.watch("require",()=>{this.propBoolean("require")?t.controls.push(this):t.remove(this)},{immediate:!0}),this.refs.text.scrollTop=this.propInt("scrollTop"),this.refs.text.scrollLeft=this.propInt("scrollLeft"),"number"!==this.props.type&&(this.refs.text.selectionStart=this.propInt("selectionStart"),this.refs.text.selectionEnd=this.propInt("selectionEnd")),this.checkWatch()}onUnmounted(){if(this.propBoolean("require")){const t=this.parentByName("content");t&&t.remove(this)}}}return s}(clickgo.modules.clickgo);