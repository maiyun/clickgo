var emodule=function(e){"use strict";function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(s){if("default"!==s){var i=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return e[s]}})}}),t.default=e,Object.freeze(t)}var s=t(e);class i extends s.control.AbstractControl{get filename(){return"/code.js"}constructor(){super(...arguments),this.emits={gesture:null,beforeselect:null,afterselect:null,select:null,clientwidth:null,clientheight:null,scrollwidth:null,scrollheight:null,"update:scrollLeft":null,"update:scrollTop":null},this.props={direction:"h",selection:!1,gesture:[],gutter:"",scrollLeft:0,scrollTop:0},this.access={selectionOrigin:{x:0,y:0},selectionCurrent:{x:0,y:0,quick:!1},selectionTimer:0},this.selectPos={start:0,end:0}}maxScrollLeft(){return this.element.scrollWidth-this.element.clientWidth}maxScrollTop(){return this.element.scrollHeight-this.element.clientHeight}onScroll(){let e=Math.round(this.element.scrollLeft);const t=this.maxScrollLeft();e>t&&(e=t),this.propInt("scrollLeft")!==e&&this.emit("update:scrollLeft",e);let i=Math.round(this.element.scrollTop);const l=this.maxScrollTop();i>l&&(i=l),this.propInt("scrollTop")!==i&&this.emit("update:scrollTop",i),this.access.selectionTimer&&this.refreshSelection(s.dom.is.shift,s.dom.is.ctrl)}wheel(e){s.dom.bindGesture(e,(e,t)=>{switch(t){case"top":if(this.element.scrollTop>0)return-1;if(this.propArray("gesture").includes("top"))return 1;break;case"bottom":if(Math.round(this.element.scrollTop)<this.maxScrollTop())return-1;if(this.propArray("gesture").includes("bottom"))return 1;break;case"left":if(this.element.scrollLeft>0)return-1;if(this.propArray("gesture").includes("left"))return 1;break;default:if(Math.round(this.element.scrollLeft)<this.maxScrollLeft())return-1;if(this.propArray("gesture").includes("right"))return 1}return 0},e=>{this.emit("gesture",e)})}down(e){if(void 0===e.target.dataset.cgFlowDownCancel&&!s.dom.findParentByData(e.target,"cg-flow-down-cancel"))if(this.propBoolean("selection")){const t=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,i=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;s.dom.bindDown(e,{start:()=>{const e=this.element.getBoundingClientRect();this.access.selectionOrigin.x=t-e.left+this.element.scrollLeft,this.access.selectionOrigin.y=i-e.top+this.element.scrollTop,this.refs.selection.style.opacity="1",this.access.selectionCurrent.x=t,this.access.selectionCurrent.y=i,this.access.selectionTimer=s.task.onFrame(this,()=>{const e=this.element.getBoundingClientRect();if(this.access.selectionCurrent.x<e.left){if(this.element.scrollLeft>0){const t=e.left-this.access.selectionCurrent.x;let s=0;this.access.selectionCurrent.quick?(s=t/2,this.access.selectionCurrent.quick=!1):s=t/5,this.element.scrollLeft-s<0&&(s=this.element.scrollLeft),this.element.scrollLeft-=s,this.emit("update:scrollLeft",Math.round(this.element.scrollLeft))}}else if(this.access.selectionCurrent.x>e.right){const t=this.maxScrollLeft();if(this.element.scrollLeft<t){const s=this.access.selectionCurrent.x-e.right;let i=0;this.access.selectionCurrent.quick?(i=s/2,this.access.selectionCurrent.quick=!1):i=s/5,this.element.scrollLeft+i>t&&(i=t-this.element.scrollLeft),this.element.scrollLeft+=i,this.emit("update:scrollLeft",Math.round(this.element.scrollLeft))}}if(this.access.selectionCurrent.y<e.top){if(this.element.scrollTop>0){const t=e.top-this.access.selectionCurrent.y;let s=0;this.access.selectionCurrent.quick?(s=t/2,this.access.selectionCurrent.quick=!1):s=t/5,this.element.scrollTop-s<0&&(s=this.element.scrollTop),this.element.scrollTop-=s,this.emit("update:scrollTop",Math.round(this.element.scrollTop))}}else if(this.access.selectionCurrent.y>e.bottom){const t=this.maxScrollTop();if(this.element.scrollTop<t){const s=this.access.selectionCurrent.y-e.bottom;let i=0;this.access.selectionCurrent.quick?(i=s/2,this.access.selectionCurrent.quick=!1):i=s/5,this.element.scrollTop+i>t&&(i=t-this.element.scrollTop),this.element.scrollTop+=i,this.emit("update:scrollTop",Math.round(this.element.scrollTop))}}},{formId:this.formId}),this.emit("beforeselect")},move:e=>{const t=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,s=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;this.access.selectionCurrent.x=t,this.access.selectionCurrent.y=s,this.access.selectionCurrent.quick=!0,this.refreshSelection(e.shiftKey,e.ctrlKey)},end:()=>{this.refs.selection.style.opacity="0",this.refs.selection.style.left="0px",this.refs.selection.style.top="0px",this.refs.selection.style.width="1px",this.refs.selection.style.height="1px",s.task.offFrame(this,this.access.selectionTimer),this.access.selectionTimer=0,this.emit("afterselect")}})}else{if(e instanceof MouseEvent)return;s.dom.bindGesture(e,(e,t)=>{switch(t){case"top":if(this.element.scrollTop>0)return-1;if(this.propArray("gesture").includes("top"))return 1;break;case"bottom":if(Math.round(this.element.scrollTop)<this.maxScrollTop())return-1;if(this.propArray("gesture").includes("bottom"))return 1;break;case"left":if(this.element.scrollLeft>0)return-1;if(this.propArray("gesture").includes("left"))return 1;break;default:if(Math.round(this.element.scrollLeft)<this.maxScrollLeft())return-1;if(this.propArray("gesture").includes("right"))return 1}return 0},e=>{this.emit("gesture",e)})}}refreshSelection(e=!1,t=!1){if(!this.access.selectionTimer)return;const s=this.element.getBoundingClientRect(),i=this.access.selectionCurrent.x-s.left+this.element.scrollLeft,l=this.access.selectionCurrent.y-s.top+this.element.scrollTop,r={start:0,end:0,empty:!1,x:0,y:0,width:0,height:0,shift:e,ctrl:t};if(i>=this.access.selectionOrigin.x){r.x=Math.round(this.access.selectionOrigin.x),r.width=Math.round(i-this.access.selectionOrigin.x);const e=this.maxScrollLeft()+this.element.clientWidth-r.x;r.width>e&&(r.width=e)}else r.x=Math.round(i),r.x<0&&(r.x=0),r.width=Math.round(this.access.selectionOrigin.x-r.x);if(l>=this.access.selectionOrigin.y){r.y=Math.round(this.access.selectionOrigin.y),r.height=Math.round(l-this.access.selectionOrigin.y);const e=this.maxScrollTop()+this.element.clientHeight-r.y;r.height>e&&(r.height=e)}else r.y=Math.round(l),r.y<0&&(r.y=0),r.height=Math.round(this.access.selectionOrigin.y-r.y);this.refs.selection.style.left=r.x.toString()+"px",this.refs.selection.style.top=r.y.toString()+"px",this.refs.selection.style.width=r.width.toString()+"px",this.refs.selection.style.height=r.height.toString()+"px";const n="v"===this.props.direction?r.y:r.x,o="v"===this.props.direction?r.height:r.width,c=this.getNewPos(this.selectPos,{start:n,end:n+o});this.selectPos.start=c.start,this.selectPos.end=c.end,r.start=c.start,r.end=c.end,r.empty=c.empty,this.emit("select",r)}getPos(e){const t=this.element.children[e];if(t&&!t.className.includes("selection"))return"h"===this.props.direction?{start:t.offsetLeft,end:t.offsetLeft+t.offsetWidth}:{start:t.offsetTop,end:t.offsetTop+t.offsetHeight}}inArea(e,t){const s=this.getPos(e);return!!s&&(s.end>t.start&&s.start<t.end)}getNewPos(e,t){const s={start:-1,end:-1,empty:!1};if(this.inArea(e.start,t)){s.start=e.start;for(let i=e.start-1;i>=0&&this.inArea(i,t);--i)s.start=i}else{let i=this.getPos(e.start);if(!i){if(0===e.start||!this.getPos(0))return{start:0,end:9,empty:!0};e.start=0,s.start=0,i=this.getPos(0)}if(t.start>i.start){for(let i=e.start+1;i<this.element.children.length-1;++i)if(this.inArea(i,t)){s.start=i;break}if(-1===s.start)return{start:0,end:9,empty:!0}}else{let i=!1;for(let l=e.start-1;l>=0;--l)if(this.inArea(l,t))i||(i=!0),s.start=l,-1===s.end&&(s.end=l);else if(i)break}}if(s.end>-1)return s;this.getPos(e.end)||(e.end=s.start);if(this.inArea(e.end,t)){s.end=e.end;for(let i=e.end+1;i<this.element.children.length-1&&this.inArea(i,t);++i)s.end=i}else{const i=this.getPos(e.end);if(t.end<i.end){for(let i=e.end-1;i>=0;--i)if(this.inArea(i,t)){s.end=i;break}}else{let i=!1;for(let l=e.end+1;l<this.element.children.length-1;++l)if(this.inArea(l,t))i||(i=!0),s.end=l;else if(i)break}}return s}onMounted(){this.watch("scrollLeft",()=>{const e=this.propInt("scrollLeft");e!==Math.round(this.element.scrollLeft)&&(this.element.scrollLeft=e,this.element.scrollLeft!==e&&this.emit("update:scrollLeft",this.element.scrollLeft))}),this.watch("scrollTop",()=>{const e=this.propInt("scrollTop");e!==Math.round(this.element.scrollTop)&&(this.element.scrollTop=e,this.element.scrollTop!==e&&this.emit("update:scrollTop",this.element.scrollTop))}),s.dom.watchSize(this,this.element,()=>{this.emit("clientwidth",this.element.clientWidth),this.emit("clientheight",this.element.clientHeight)},!0),s.dom.watchProperty(this.element,["scrollWidth","scrollHeight"],(e,t)=>{this.emit(e.toLowerCase(),t)},!0),this.element.scrollTop=this.propInt("scrollTop"),this.element.scrollLeft=this.propInt("scrollLeft")}}return i}(clickgo.modules.clickgo);