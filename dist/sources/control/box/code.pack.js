var emodule=function(e){"use strict";function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(s){if("default"!==s){var i=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return e[s]}})}}),t.default=e,Object.freeze(t)}var s=t(e);class i extends s.control.AbstractControl{get filename(){return"/code.js"}emits={"update:selected":null};props={modelValue:{},selected:[]};isInteract=!1;isSelection=!1;selectedData=[];get modelValueComp(){const e=Object.keys(this.props.modelValue).map(e=>({id:e,...this.props.modelValue[e]}));return e.sort((e,t)=>(e.index??1)-(t.index??1)),e}wrapDown(e){if(e.target!==e.currentTarget)return;e.ctrlKey||e.metaKey||(this.selectedData.length=0,this.updateSelected());const t=this.element.getBoundingClientRect(),i=e.clientX,o=e.clientY;s.modules.pointer.down(e,{start:()=>{this.isSelection=!0},move:e=>{const s=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,l=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;s>i?(this.refs.selection.setAttribute("x",(i-t.left).toString()),this.refs.selection.setAttribute("width",(s-i).toString())):(this.refs.selection.setAttribute("x",(s-t.left).toString()),this.refs.selection.setAttribute("width",(i-s).toString())),l>o?(this.refs.selection.setAttribute("y",(o-t.top).toString()),this.refs.selection.setAttribute("height",(l-o).toString())):(this.refs.selection.setAttribute("y",(l-t.top).toString()),this.refs.selection.setAttribute("height",(o-l).toString()))},end:e=>{const t=Math.round(parseFloat(this.refs.selection.getAttribute("x"))),s=Math.round(parseFloat(this.refs.selection.getAttribute("width")))+t,i=Math.round(parseFloat(this.refs.selection.getAttribute("y"))),o=Math.round(parseFloat(this.refs.selection.getAttribute("height")))+i;e.ctrlKey||e.metaKey||(this.selectedData.length=0);for(const e in this.props.modelValue){const l=this.props.modelValue[e];s<l.x||t>l.x+l.width||o<l.y||i>l.y+l.height||(this.selectedData.includes(e)||this.selectedData.push(e))}this.updateSelected(),this.refs.selection.setAttribute("x","0"),this.refs.selection.setAttribute("y","0"),this.refs.selection.setAttribute("width","1"),this.refs.selection.setAttribute("height","1"),this.isSelection=!1}})}resize(e,t,i){s.modules.pointer.resize(e,{objectLeft:this.props.modelValue[t].x,objectTop:this.props.modelValue[t].y,objectWidth:this.props.modelValue[t].width,objectHeight:this.props.modelValue[t].height,border:i,start:()=>{this.isInteract=!0},move:(e,s,i,o)=>{let l=this.props.modelValue[t],r=l.x;l.x=e,r=l.x-r;let c=l.y;l.y=s,c=l.y-c;let h=l.width;l.width=i,h=l.width-h;let n=l.height;l.height=o,n=l.height-n;for(const e of this.selectedData)e!==t&&(l=this.props.modelValue[e],l.x+=r,l.y+=c,l.width+=h,l.height+=n)},end:()=>{this.isInteract=!1}})}down(e,t){this.selectedData.includes(t)||(e.ctrlKey||e.metaKey||(this.selectedData.length=0),this.selectedData.push(t)),this.updateSelected(),!1!==this.props.modelValue[t].move&&s.modules.pointer.move(e,{areaObject:this.element,object:e.currentTarget,cursor:"auto",start:()=>{this.isInteract=!0},move:(e,t)=>{for(const e of this.selectedData)this.props.modelValue[e].x+=t.ox,this.props.modelValue[e].y+=t.oy},end:()=>{this.isInteract=!1}})}onMounted(){this.watch("modelValue",()=>{for(let e=0;e<this.selectedData.length;++e){const t=this.selectedData[e];this.props.modelValue[t]||(this.selectedData.splice(e,1),--e)}this.updateSelected()}),this.watch("selected",()=>{this.selectedData=s.tool.clone(this.propArray("selected"))},{deep:!0,immediate:!0})}updateSelected(){this.selectedData.length===this.propArray("selected").length&&this.selectedData.every(e=>this.propArray("selected").includes(e))||this.emit("update:selected",s.tool.clone(this.selectedData))}}return i}(clickgo.modules.clickgo);