var emodule=function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var i=e(t);class s extends i.control.AbstractControl{get filename(){return"/code.js"}constructor(){super(...arguments),this.emits={durationchange:null,canplay:null,canplaythrough:null,emptied:null,ended:null,error:null,loadeddata:null,loadedmetadata:null,loadstart:null,playing:null,progress:null,ratechange:null,readystatechange:null,seeked:null,seeking:null,stalled:null,suspend:null,waiting:null,"update:current":null,"update:play":null},this.props={src:"",controls:!1,loop:!1,muted:!1,volume:50,play:!1,current:0},this.srcData="",this.isBlob=!1,this.count=0,this.duration=0,this.inBar=!1,this.hideTimer=0,this.isShow=!1,this.currentData=0,this._currentTimer=0,this.playData=!1,this.bcurrent=0}onDurationchange(){this.refs.video&&(this.duration=this.refs.video.duration,this.emit("durationchange",this.duration))}get durations(){return i.tool.formatSecond(this.duration)}currentUpdateStart(){this._currentTimer||(this._currentTimer=i.task.onFrame(this,()=>{this.currentData!==this.refs.video.currentTime&&(this.currentData=this.refs.video.currentTime,this.emit("update:current",this.currentData))},{formId:this.formId}))}currentUpdateEnd(){this._currentTimer&&(i.task.offFrame(this,this._currentTimer),this._currentTimer=0)}get currents(){return i.tool.formatSecond(this.currentData)}onPlay(){this.playData||(this.currentUpdateStart(),this.playData=!0,this.emit("update:play",this.playData))}onPause(){this.playData&&(this.currentUpdateEnd(),this.playData=!1,this.emit("update:play",this.playData))}playClick(){this.playData?(this.refs.video.pause(),this.currentUpdateEnd()):(this.refs.video.play(),this.currentUpdateStart()),this.playData=!this.playData,this.emit("update:play",this.playData)}async fullClick(){i.dom.is.full?await i.dom.exitFullscreen():await this.element.requestFullscreen()}get isFull(){return i.dom.is.full}onMouseEnter(t){i.dom.hasTouchButMouse(t)||this.propBoolean("controls")&&(this.isShow=!0,this.hideTimer&&(i.task.removeTimer(this,this.hideTimer),this.hideTimer=0))}onMouseLeave(t){i.dom.hasTouchButMouse(t)||this.propBoolean("controls")&&(this.hideTimer=i.task.sleep(this,()=>{this.isShow=!1},800))}onTouch(t){this.propBoolean("controls")&&i.dom.bindDown(t,{down:()=>{this.isShow=!0,this.hideTimer&&(i.task.removeTimer(this,this.hideTimer),this.hideTimer=0)},up:()=>{this.hideTimer=i.task.sleep(this,()=>{this.isShow=!1},800)}})}get bcurrents(){return i.tool.formatSecond(this.bcurrent)}onBMove(t){if(i.dom.hasTouchButMouse(t))return;this.inBar=!0;const e=this.refs.top.getBoundingClientRect(),s=t.clientX-e.left;this.bcurrent=s/e.width*this.duration}onBLeave(t){i.dom.hasTouchButMouse(t)||(this.inBar=!1)}onBClick(t){i.dom.hasTouchButMouse(t)||(this.currentData=this.bcurrent,this.refs.video.currentTime=this.currentData,this.emit("update:current",this.currentData))}onBTouch(t){const e=this.refs.top.getBoundingClientRect();i.dom.bindDown(t,{move:t=>{this.inBar=!0;const i=t.touches[0].clientX-e.left;this.bcurrent=i/e.width*this.duration},up:()=>{this.inBar=!1,this.currentData=this.bcurrent,this.refs.video.currentTime=this.currentData,this.emit("update:current",this.currentData)}})}onCanplay(){this.playData=this.propBoolean("play"),this.playData&&!this._currentTimer&&(this.refs.video.play(),this.currentUpdateStart()),this.emit("canplay")}onMounted(){this.watch("src",async()=>{const t=++this.count;if("string"!=typeof this.props.src||""===this.props.src)return this.isBlob&&(this.isBlob=!1,URL.revokeObjectURL(this.srcData)),void(this.srcData="");const e=this.props.src.slice(0,6).toLowerCase();if("file:/"===e)return this.isBlob&&(this.isBlob=!1,URL.revokeObjectURL(this.srcData)),void(this.srcData="");if("http:/"===e||"https:"===e||e.startsWith("data:"))return this.isBlob&&(this.isBlob=!1,URL.revokeObjectURL(this.srcData)),void(this.srcData=this.props.src);const s=i.tool.urlResolve("/package"+this.path+"/",this.props.src),r=await i.fs.getContent(this,s);if(t!==this.count||!r||"string"==typeof r)return;this.isBlob&&URL.revokeObjectURL(this.srcData);const a=URL.createObjectURL(r);this.srcData=a},{immediate:!0}),this.watch("volume",()=>{this.refs.video.volume=this.propInt("volume")/100},{immediate:!0}),this.watch("controls",()=>{this.propBoolean("controls")?(this.isShow=!0,this.hideTimer=i.task.sleep(this,()=>{this.isShow=!1},800)):this.hideTimer&&(i.task.removeTimer(this,this.hideTimer),this.hideTimer=0)},{immediate:!0}),this.watch("play",()=>{this.playData!==this.propBoolean("play")&&(this.playData=this.propBoolean("play"),this.playData?(this.refs.video.play(),this.currentUpdateStart()):(this.refs.video.pause(),this.currentUpdateEnd()))})}onUnmounted(){this.isBlob&&URL.revokeObjectURL(this.srcData)}}return s}(clickgo.modules.clickgo);