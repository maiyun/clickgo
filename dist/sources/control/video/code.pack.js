var emodule=function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var i=e(t);class r extends i.control.AbstractControl{get filename(){return"/code.js"}emits={durationchange:null,canplay:null,canplaythrough:null,emptied:null,ended:null,error:null,loadeddata:null,loadedmetadata:null,loadstart:null,playing:null,progress:null,ratechange:null,readystatechange:null,seeked:null,seeking:null,stalled:null,suspend:null,waiting:null,"update:current":null,"update:play":null};props={src:"",controls:!1,loop:!1,muted:!1,volume:50,play:!1,current:0};srcData="";isBlob=!1;count=0;duration=0;inBar=!1;hideTimer=0;isShow=!1;onDurationchange(){this.refs.video&&(this.duration=this.refs.video.duration,this.emit("durationchange",this.duration))}get durations(){return i.tool.formatSecond(this.duration)}currentData=0;_currentTimer=0;currentUpdateStart(){this._currentTimer||(this._currentTimer=i.task.onFrame(this,()=>{this.currentData!==this.refs.video.currentTime&&(this.currentData=this.refs.video.currentTime,this.emit("update:current",this.currentData))},{formId:this.formId}))}currentUpdateEnd(){this._currentTimer&&(i.task.offFrame(this,this._currentTimer),this._currentTimer=0)}get currents(){return i.tool.formatSecond(this.currentData)}playData=!1;onPlay(){this.playData||(this.currentUpdateStart(),this.playData=!0,this.emit("update:play",this.playData))}onPause(){this.playData&&(this.currentUpdateEnd(),this.playData=!1,this.emit("update:play",this.playData))}playClick(){this.playData?(this.refs.video.pause(),this.currentUpdateEnd()):(this.refs.video.play(),this.currentUpdateStart()),this.playData=!this.playData,this.emit("update:play",this.playData)}async fullClick(){i.dom.is.full?await i.dom.exitFullscreen():await this.element.requestFullscreen()}get isFull(){return i.dom.is.full}onDown(t){this.propBoolean("controls")&&i.modules.pointer.hover(t,{enter:()=>{this.isShow=!0,this.hideTimer&&(i.task.removeTimer(this,this.hideTimer),this.hideTimer=0)},leave:()=>{this.hideTimer=i.task.sleep(this,()=>{this.isShow=!1},800)}})}bcurrent=0;get bcurrents(){return i.tool.formatSecond(this.bcurrent)}onBDown(t){i.modules.pointer.down(t,{up:()=>{this.currentData=this.bcurrent,this.refs.video.currentTime=this.currentData,this.emit("update:current",this.currentData)}}),this.onBEnter(t)}onBEnter(t){i.modules.pointer.hover(t,{enter:t=>{this.inBar=!0;const e=this.refs.top.getBoundingClientRect(),i=t.clientX-e.left;this.bcurrent=i/e.width*this.duration},move:t=>{const e=this.refs.top.getBoundingClientRect(),i=t.clientX-e.left;this.bcurrent=i/e.width*this.duration},leave:()=>{this.inBar=!1}})}onCanplay(){this.playData=this.propBoolean("play"),this.playData&&!this._currentTimer&&(this.refs.video.play(),this.currentUpdateStart()),this.emit("canplay")}onMounted(){this.watch("src",async()=>{const t=++this.count;if("string"!=typeof this.props.src||""===this.props.src)return this.isBlob&&(this.isBlob=!1,URL.revokeObjectURL(this.srcData)),void(this.srcData="");const e=this.props.src.slice(0,6).toLowerCase();if("file:/"===e)return this.isBlob&&(this.isBlob=!1,URL.revokeObjectURL(this.srcData)),void(this.srcData="");if("http:/"===e||"https:"===e||e.startsWith("data:"))return this.isBlob&&(this.isBlob=!1,URL.revokeObjectURL(this.srcData)),void(this.srcData=this.props.src);const r=i.tool.urlResolve("/package"+this.path+"/",this.props.src),s=await i.fs.getContent(this,r);if(t!==this.count||!s||"string"==typeof s)return;this.isBlob&&URL.revokeObjectURL(this.srcData);const a=URL.createObjectURL(s);this.srcData=a},{immediate:!0}),this.watch("volume",()=>{this.refs.video.volume=this.propInt("volume")/100},{immediate:!0}),this.watch("controls",()=>{this.propBoolean("controls")?(this.isShow=!0,this.hideTimer=i.task.sleep(this,()=>{this.isShow=!1},800)):this.hideTimer&&(i.task.removeTimer(this,this.hideTimer),this.hideTimer=0)},{immediate:!0}),this.watch("play",()=>{this.playData!==this.propBoolean("play")&&(this.playData=this.propBoolean("play"),this.playData?(this.refs.video.play(),this.currentUpdateStart()):(this.refs.video.pause(),this.currentUpdateEnd()))})}onUnmounted(){this.isBlob&&URL.revokeObjectURL(this.srcData)}}return r}(clickgo.modules.clickgo);