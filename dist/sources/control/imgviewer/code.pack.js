var emodule=function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(s){if("default"!==s){var i=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:function(){return t[s]}})}}),e.default=t,Object.freeze(e)}var s=e(t);class i extends s.control.AbstractControl{get filename(){return"/code.js"}constructor(){super(...arguments),this.props={src:[],modelValue:0},this.width=0,this.height=0,this.imgData="",this.count=0,this.scaleS=1,this.scaleX=0,this.scaleY=0}async refreshImgData(){const t=++this.count,e=this.propArray("src")[this.propNumber("modelValue")];if(!e)return;if("string"!=typeof e||""===e)return void(this.imgData="");const i=e.slice(0,6).toLowerCase();if("file:/"===i)return void(this.imgData="");if("http:/"===i||"https:"===i||i.startsWith("data:"))return void(this.imgData=e);let h=null;if(e.startsWith("/control/")){if(!this.rootControl)return;h=this.rootControl.packageFiles[e.slice(8)]}else{const t=s.tool.urlResolve("/package"+this.path+"/",e);h=await s.fs.getContent(this,t)}if(t!==this.count||!h||"string"==typeof h)return;const a=await s.tool.blob2DataUrl(h);t===this.count&&(this.imgData=a||"")}scale(t){s.dom.bindScale(t,(t,e,s)=>{t.preventDefault(),this.scaleX+=s.x,this.scaleY+=s.y,this.scaleS*=e,this.scaleS>5?this.scaleS=5:this.scaleS<.05&&(this.scaleS=.05)})}load(){this.refs.img.offsetWidth/this.refs.img.offsetHeight>this.width/this.height?this.scaleS=this.width/this.refs.img.offsetWidth:this.scaleS=this.height/this.refs.img.offsetHeight,this.scaleS<.05&&(this.scaleS=.05)}onMounted(){s.dom.watchSize(this,this.element,()=>{this.width=this.element.offsetWidth,this.height=this.element.offsetHeight},!0),this.watch("modelValue",async(t,e)=>{t!==e&&(this.scaleX=0,this.scaleY=0,this.scaleS=1,await this.refreshImgData())}),this.watch("src",async()=>{await this.refreshImgData()},{deep:!0,immediate:!0})}}return i}(clickgo.modules.clickgo);