import*as e from"../../index.js";const t=document.getElementById("state"),n=document.getElementById("iconwrap"),d=document.getElementsByTagName("body")[0];let s=null;class a extends e.AbstractBoot{main(){t.insertAdjacentHTML("afterbegin","<div>Initialized.</div>"),document.getElementById("download")?.addEventListener("click",()=>{(async()=>{document.getElementById("download")?.remove(),t.insertAdjacentHTML("afterbegin","<div>Starting download ...</div>"),s=await e.core.fetchApp(this._sysId,"./app.cga",{progress:(e,n)=>{t.insertAdjacentHTML("afterbegin","<div>Progress "+e.toString()+" / "+n.toString()+" ("+Math.round(e/n*100).toString()+"%)</div>")}}),s?(n.style.display="flex",document.getElementById("fl").style.display="block",document.getElementById("icon").style.backgroundImage="url("+s.icon+")",document.getElementById("mask").style.webkitMaskImage="url("+s.icon+")",document.getElementById("mask").style.maskImage="url("+s.icon+")"):t.insertAdjacentHTML("afterbegin","<div>Network error.</div>")})()}),n.addEventListener("mousedown",e=>{e.stopPropagation(),n.classList.add("selected")}),n.addEventListener("dblclick",()=>{(async()=>{d.style.cursor="progress",n.classList.remove("selected"),await e.task.run(this._sysId,s,{initProgress:e=>{t.insertAdjacentHTML("afterbegin","<div> "+e+"</div>")}}),d.style.cursor="default"})()}),document.addEventListener("mousedown",()=>{n.classList.remove("selected")})}onError(n,d,s){t.insertAdjacentHTML("afterbegin","<div>Error, Task ID: "+n.toString()+", Form ID: "+d.toString()+"<br>"+(s.stack?s.stack.replace(/\n/g,"<br>"):"")+"</div>"),e.task.end(n).catch(()=>{})}onTaskEnded(e){t.insertAdjacentHTML("afterbegin","<div>Task "+e.toString()+" ended.</div>")}}await e.launcher(new a);